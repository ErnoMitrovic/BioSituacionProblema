---
title: "Situación problema"
author: 
  - Alejandro Sánchez A01662783
  - Daniel Rong A01656992
  - Ernesto Miranda A01656828
  - José Aram Méndez A01657142
  - Juan Antonio Mancera A01662634
  - Lisa Valeria Rodríguez A01656306
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Incluir reporte aquí
```{r, include = FALSE}
# Agrega el working directory
setwd("G:\\Mi unidad\\ESCUELA\\Profesional\\2 Semestre\\Biologia_Computacional\\SituacionProblema\\codigo")
```

1. Obtén las secuencias de las variantes de SARS-CoV-2 desde el NCBI o el buscador de virus del NCBI.
```{r}
# Utiliza el paquete seqinr
library(seqinr)
variants <- c(
  "alpha" = read.fasta("./fasta/alpha.fasta"),
  "beta" = read.fasta("./fasta/beta.fasta"),
  "epsilon" = read.fasta("./fasta/epsilon.fasta"),
  "eta" = read.fasta("./fasta/eta.fasta"),
  "gamma" = read.fasta("./fasta/gamma.fasta"),
  "iota" = read.fasta("./fasta/iota.fasta"),
  "kappa" = read.fasta("./fasta/kappa.fasta"),
  "mu" = read.fasta("./fasta/mu.fasta"),
  "omicron" = read.fasta("./fasta/omicron.fasta"),
  "zeta" = read.fasta("./fasta/zeta.fasta")
  )
names(variants) <- c("alpha", "beta", "epsilon", "eta", "gamma", "iota", "kappa", "mu", "omicron", "zeta")
```
2. Calcula la longitud de las secuencias de cada variante.
```{r}
lengthVars <- c()
for(i in names(variants)){
  lengthVars[i] <- length(variants[i][[1]])
  rm(i)
}
names(lengthVars) <- names(variants)
```
3. Crea una gráfica donde compares las bases de ADN que componen a cada una de las variantes del virus.
```{r}
countBase <- function(chain, base) {
  cont <- 0
  for(el in chain){
    if(el == base) cont <- cont + 1
  }
  return(cont)
}

Ac <- sapply(variants, countBase, base = "a")
Cc <- sapply(variants, countBase, base = "c")
Gc <- sapply(variants, countBase, base = "g")
Tc <- sapply(variants, countBase, base = "t")

barplot(matrix(c(Ac, Cc, Gc, Tc), nrow = 4, byrow = TRUE), beside = TRUE, col=c(rgb(0.3,0.1,0.4,0.6) , rgb(0.3,0.5,0.4,0.6) , rgb(0.3,0.9,0.4,0.6) ,  rgb(0.15,0.53,0.71,0.6)), las =2, names.arg= names(variants))
legend("topleft",legend = c("A","C","G", "T") , 
     col = c(rgb(0.3,0.1,0.4,0.6) , rgb(0.3,0.5,0.4,0.6) , rgb(0.3,0.9,0.4,0.6) ,  rgb(0.15,0.53,0.71,0.6)),  pt.cex = 0.8, pch = 15 , cex = 0.5)

```
4. ¿Cuál es el %GC de cada variante?
```{r}
GCperc <- c()
for(i in names(variants)){
  GCperc <- c(GCperc, GC(variants[i][[1]]))
}
names(GCperc) <- names(variants)
```

5. Crea las secuencias contrasentido de cada variante.
```{r}
contra <- c()
for(i in names(variants)){
  contra <- c(contra, paste(comp(variants[i][[1]]), collapse = ''))
}
names(contra) <- names(variants)
```

6. Agrega una interpretación escrita de las gráficas que integras.