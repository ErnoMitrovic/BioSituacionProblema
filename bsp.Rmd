---
title: "Situación problema"
author: "Ernesto Miranda"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Incluir reporte aquí
```{r, include = FALSE}
# Agrega el working directory
setwd("G:\\Mi unidad\\ESCUELA\\Profesional\\2 Semestre\\Biologia_Computacional\\SituacionProblema\\codigo")
```

1. Obtén las secuencias de las variantes de SARS-CoV-2 desde el NCBI o el buscador de virus del NCBI.
```{r}
# Utiliza el paquete seqinr
library(seqinr)
variants <- c(
  "alpha" = read.fasta("./fasta/alpha.fasta"),
  "beta" = read.fasta("./fasta/beta.fasta"),
  "epsilon" = read.fasta("./fasta/epsilon.fasta"),
  "eta" = read.fasta("./fasta/eta.fasta"),
  "gamma" = read.fasta("./fasta/gamma.fasta"),
  "iota" = read.fasta("./fasta/iota.fasta"),
  "kappa" = read.fasta("./fasta/kappa.fasta"),
  "mu" = read.fasta("./fasta/mu.fasta"),
  "omicron" = read.fasta("./fasta/omicron.fasta"),
  "zeta" = read.fasta("./fasta/zeta.fasta")
  )
names(variants) <- c("alpha", "beta", "epsilon", "eta", "gamma", "iota", "kappa", "mu", "omicron", "zeta")
```
2. Calcula la longitud de las secuencias de cada variante.
```{r}
lengthVars <- c()
for(i in names(variants)){
  lengthVars[i] <- length(variants[i][[1]])
  rm(i)
}
names(lengthVars) <- names(variants)
```
3. Crea una gráfica donde compares las bases de ADN que componen a cada una de las variantes del virus.
```{r}
data <- c()
for(i in names(variants))
  data <- c(data, table(variants[i][[1]]))

dataNames <- c()
for (i in 1:length(variants)){
  for(base in c("A", "C", "G", "T")){
    dataNames <- c(dataNames, base)
  }
}
names(data) <- dataNames
barplot(data, 
        col=c(rgb(0.3,0.1,0.4,0.6) , rgb(0.3,0.5,0.4,0.6) , rgb(0.3,0.9,0.4,0.6) ,  rgb(0.15,0.53,0.71,0.6)),
        main="")

abline(v=c(4.9, 9.7, 14.5, 19.4, 24.2, 29, 33.8, 38.6, 43.4), col="red")

legend("topleft", legend = c("A","C","G", "T") , 
     col = c(rgb(0.3,0.1,0.4,0.6) , rgb(0.3,0.5,0.4,0.6) , rgb(0.3,0.9,0.4,0.6) ,  rgb(0.15,0.53,0.71,0.6)), pch=20 , pt.cex = 2, cex = 0.8, horiz = FALSE, inset = c(0.05, 0.05))
```
4. ¿Cuál es el %GC de cada variante?
```{r}
percentageGC <- function(chain){
  bases <- c("g", "c")
  percentages <- numeric(2)
  for (el in chain) {
    for (i in 1:2){
      if (el == bases[i]) percentages[i] <- percentages[i] + 1
    }
  }
  return((percentages[1] + percentages[2])/length(chain))
}
GCperc <- c()
for(i in names(variants)){
  GCperc <- c(GCperc, percentageGC(variants[i][[1]]))
}
names(GCperc) <- names(variants)
```

5. Crea las secuencias contrasentido de cada variante.
```{r}

```

6. Agrega una interpretación escrita de las gráficas que integras.