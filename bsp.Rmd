---
title: "Situación problema"
author: 
  - Alejandro Sánchez A01662783
  - Daniel Rong A01656992
  - Ernesto Miranda A01656828
  - José Aram Méndez A01657142
  - Juan Antonio Mancera A01662634
  - Lisa Valeria Rodríguez A01656306
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<center>
![Logo Tec](./img/logoTec.png)
**Analisis de biologia computacional**
# BT1013.324  
## Evidencia 1 | Análisis inicial  
## Equipo 2
**Profesores: **  
Dra Laura Gómez  
Dr. Hugo Tovar  
Febrero – Junio  
Fecha de entrega: 26/04/2022  
</center>

**1. ¿Cuál es la situación actuals de COVID-19 a nivel mundial, en México, en tu estado de origen y en tu municipio, alcaldía o colonia? **
Gracias a la aplicación de las diferentes vacunas, el SARS COV 2 ha bajado su nivel de alarma en el mundo. A pesar de esta evidente mejora, los contagios siguen aún sin detenerse. Un claro ejemplo es el continente Europeo, el cual sigue manteniéndose como el continente con más casos reportados al día de hoy y de igual forma Estados Unidos como uno de los países con mayor número de contagios.  
![Mapa mundial](./img/worldMap.png)  
Enfocándonos en la situación actual de nuestro país y gracias a los datos obtenidos en los últimos 14 días por el gobierno Mexicano, podemos observar la mejoría en la situación ante la pandemia por COVID-19, teniendo solamente 11,806 nuevos casos reportados en todo el país.  
Por su parte la Ciudad de México, al ser uno de los estados con mayor número de habitantes también se mantiene como el segundo estado de la república con el mayor número de contagios en los últimos 14 días, pero manteniendo un margen de aproximadamente 200 casos por día.  
En cuanto a la distribución de contagios por alcaldía, podemos ver que tanto la alcaldía Iztapalapa y la alcaldía Tlalpan poseen el mayor número de casos reportados tanto de contagios como de muertes. A pesar de todo esto, se puede concluir que la tendencia actual de la pandemia se encuentra en decrecimiento.  
**2. ¿Cuál fue la primera variante del virus que se propagó a todo el mundo?**
La variante de SARS-CoV-2 B. 1.1.7, también conocida como variante alfa, fue identificada por primera vez en Reino Unido en septiembre del 2020. Para el mes de Diciembre aumentaron las infecciones por esta variante, poco después se vieron más casos alrededor del mundo. En enero de 2021, en Estados Unidos se estableció como la variante más predominante. La variante alfa porta una mutación en la proteína S que afecta la conformación del dominio de unión al receptor, posee una mutación la cual es la eliminación en las posiciones 69 y 70, la cual le da la carácter de mayor transmisibilidad. Esta variante perdió relevancia con el surgimiento de la variante Delta, la cual era más agresiva. {Galloway, 2021}

```{r, include = FALSE}
# Agrega el working directory
setwd("G:\\Mi unidad\\ESCUELA\\Profesional\\2 Semestre\\Biologia_Computacional\\SituacionProblema\\codigo")
```

1. Obtén las secuencias de las variantes de SARS-CoV-2 desde el NCBI o el buscador de virus del NCBI.
```{r}
# Utiliza el paquete seqinr
library(seqinr)
variants <- c(
  alpha = read.fasta("./fasta/alpha.fasta"),
  beta = read.fasta("./fasta/beta.fasta"),
  epsilon = read.fasta("./fasta/epsilon.fasta"),
  eta = read.fasta("./fasta/eta.fasta"),
  gamma = read.fasta("./fasta/gamma.fasta"),
  iota = read.fasta("./fasta/iota.fasta"),
  kappa = read.fasta("./fasta/kappa.fasta"),
  mu = read.fasta("./fasta/mu.fasta"),
  omicron = read.fasta("./fasta/omicron.fasta"),
  zeta = read.fasta("./fasta/zeta.fasta")
  )
names(variants) <- c("alpha", "beta", "epsilon", "eta", "gamma", "iota", "kappa", "mu", "omicron", "zeta")
```
2. Calcula la longitud de las secuencias de cada variante.
```{r}
lengthVars <- c()
for(i in names(variants)){
  lengthVars[i] <- length(variants[i][[1]])
  rm(i)
}
names(lengthVars) <- names(variants)
```
3. Crea una gráfica donde compares las bases de ADN que componen a cada una de las variantes del virus.
```{r}
bases <- function(chains){
  comps <- lapply(chains, table)
  b <- c()
  for(el in comps){
    b <- c(b,as.numeric(el))
  }
  return(list(
    a = b[seq(from = 1, to = length(b), by = 4)],
    c = b[seq(from = 2, to = length(b), by = 4)],
    g = b[seq(from = 3, to = length(b), by = 4)],
    t = b[seq(from = 4, to = length(b), by = 4)]
  ))
}

B <- bases(variants)

colors <- c("pink", "blue", "purple", "cyan", "magenta", "gray", "red", "black", "green", "orange")

par(mar = c(5,4,4,8), xpd = T)
barplot(matrix(c(B$a, B$c, B$g, B$t), nrow = 10), beside = TRUE, col = colors, las =2, names.arg = c("A", "C", "G", "T"), ylab = "Frecuencia", xlab = "Bases")
legend("topright",legend = names(variants) , col = colors,  pt.cex = 1, pch = 15 , cex = 1, inset = c(-0.2,0))
rm(colors)

```
4. ¿Cuál es el %GC de cada variante?
```{r}
GCperc <- c()
for(i in names(variants)){
  GCperc <- c(GCperc, GC(variants[i][[1]]))
}
rm(i)
names(GCperc) <- names(variants)
```

5. Crea las secuencias contrasentido de cada variante.
```{r}
inv <- function(chain){
  return(chain[length(chain):1])
}

contra <- lapply(variants, inv)
names(contra) <- names(variants)
```

6. Agrega una interpretación escrita de las gráficas que integras.